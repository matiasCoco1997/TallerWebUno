<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700,900&display=swap" rel="stylesheet"/>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tw-elements/dist/css/tw-elements.min.css"/>
    <script src="https://cdn.tailwindcss.com/3.3.0"></script>
    <!--Slick-->
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/slick-carousel@1.8.1/slick/slick.css"/>
    <link rel="stylesheet" type="text/css"
          href="https://cdn.jsdelivr.net/npm/slick-carousel@1.8.1/slick/slick-theme.css"/>

    <title>Lista de reproducción</title>
    <link rel="icon" href="imagenes/icono-sunn.png" type="image/x-icon">

</head>

<body class="bg-black">

<!-- Main navigation container -->
<nav style="background-color: black"
     class="flex-no-wrap relative flex w-full items-center justify-between bg-[#FBFBFB] py-2 shadow-md shadow-black/5 dark:bg-black dark:shadow-black/10 lg:flex-wrap lg:justify-start lg:py-4">
    <div class="flex w-full flex-wrap items-center justify-between px-3">

        <!-- Logo -->
        <a class="mb-4 ml-1  mt-3 flex items-center text-neutral-900 hover:text-neutral-900 focus:text-neutral-900 dark:text-neutral-200 dark:hover:text-neutral-400 dark:focus:text-neutral-400 lg:mb-0 lg:mt-0"
           href="home">
            <img src="https://www.metal-archives.com/images/6/1/2/612_logo.jpg?5737" style="height: 15px"
                 alt="TE Logo" loading="lazy"/>
        </a>

        <!-- Right elements -->
        <div class="relative flex items-center">

            <div class="relative">
                <a class="mr-4 flex items-center" th:href="@{/notificaciones}">
          <span class="[&>svg]:w-5">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"
                                 class="h-5 w-5">
                                <path fill-rule="evenodd"
                                      d="M5.25 9a6.75 6.75 0 0113.5 0v.75c0 2.123.8 4.057 2.118 5.52a.75.75 0 01-.297 1.206c-1.544.57-3.16.99-4.831 1.243a3.75 3.75 0 11-7.48 0 24.585 24.585 0 01-4.831-1.244.75.75 0 01-.298-1.205A8.217 8.217 0 005.25 9.75V9zm4.502 8.9a2.25 2.25 0 104.496 0 25.057 25.057 0 01-4.496 0z"
                                      clip-rule="evenodd"/>
                            </svg>
                    </span>
                    <span class="absolute -mt-4 ml-2.5 rounded-full bg-danger px-[0.35em] py-[0.15em] text-[0.6rem] font-bold leading-none text-white"
                          th:text="${notificaciones}"></span>
                </a>
            </div>

            <!-- Second dropdown container -->
            <div class="relative" data-te-dropdown-ref data-te-dropdown-alignment="end">
                <!-- Second dropdown trigger -->
                <a class="hidden-arrow flex items-center whitespace-nowrap transition duration-150 ease-in-out motion-reduce:transition-none"
                   href="" id="dropdownMenuButton2" role="button" data-te-dropdown-toggle-ref
                   aria-expanded="false">
                    <!-- User avatar -->
                    <img th:src="@{${usuario.fotoPerfil}}" class="rounded-full"
                         style="height: 25px; width: 25px" th:alt="@{${usuario.altFotoPerfil}}" loading="lazy"/>
                </a>
                <!-- Second dropdown menu -->
                <ul class="absolute z-[1000] float-left m-0 hidden min-w-max list-none overflow-hidden rounded-lg border-none bg-white bg-clip-padding text-left text-base shadow-lg dark:bg-neutral-700 [&[data-te-dropdown-show]]:block"
                    aria-labelledby="dropdownMenuButton2" data-te-dropdown-menu-ref>
                    <!-- Second dropdown menu items -->
                    <li>
                        <a class="block w-full whitespace-nowrap bg-transparent px-4 py-2 text-sm font-normal text-neutral-700 hover:bg-neutral-100 active:text-neutral-800 active:no-underline disabled:pointer-events-none disabled:bg-transparent disabled:text-neutral-400 dark:text-neutral-200 dark:hover:bg-white/30"
                           th:href="@{/perfil}" data-te-dropdown-item-ref>Ver Perfil</a>
                    </li>

                    <li>
                        <a class="block w-full whitespace-nowrap bg-transparent px-4 py-2 text-sm font-normal text-neutral-700 hover:bg-neutral-100 active:text-neutral-800 active:no-underline disabled:pointer-events-none disabled:bg-transparent disabled:text-neutral-400 dark:text-neutral-200 dark:hover:bg-white/30"
                           th:href="@{/siguiendo}" data-te-dropdown-item-ref>Siguiendo</a>
                    </li>

                    <li>
                        <a class="block w-full whitespace-nowrap bg-transparent px-4 py-2 text-sm font-normal text-neutral-700 hover:bg-neutral-100 active:text-neutral-800 active:no-underline disabled:pointer-events-none disabled:bg-transparent disabled:text-neutral-400 dark:text-neutral-200 dark:hover:bg-white/30"
                           th:href="@{/listaReproduccion}" data-te-dropdown-item-ref>Ver lista de reproducción</a>
                    </li>

                    <li class="bg-danger">
                        <a class="block w-full whitespace-nowrap bg-transparent px-4 py-2 text-sm font-normal text-neutral-700 hover:bg-neutral-100 active:text-neutral-800 active:no-underline disabled:pointer-events-none disabled:bg-transparent disabled:text-neutral-400 dark:text-neutral-200 dark:hover:bg-white/30"
                           th:href="@{/cerrar-sesion}" data-te-dropdown-item-ref>Cerrar Sesion</a>
                    </li>
                </ul>
            </div>
        </div>
    </div>
</nav>

<main class="h-[100vh] ">
    <div class="">
        <h3 class="text-white text-6xl font-bold ml-6 mb-6 md:text-center">Mis Listas de Reproducción</h3>

        <div th:if="${listaReproduccion != null and listaReproduccion.size() > 0}"
             th:style="'background-image: url(/sunn/' + ${listaReproduccion[0].noticia.rutaDeimagen} + ');'"
             class="relative overflow-hidden bg-cover bg-no-repeat bg-[50%] h-[600px]">
            <div
                    class="absolute top-0 right-0 bottom-0 left-0 h-full w-full overflow-hidden bg-fixed bg-[hsla(0,0%,0%,0.75)]">
                <div class="xl:flex xl:flex-row h-full items-center justify-center flex-col">
                    <div class="px-6 text-center text-white md:px-12 xl:w-3/6">
                        <div class="mt-18">
                            <a class="hidden-arrow flex items-center whitespace-nowrap transition duration-150 ease-in-out motion-reduce:transition-none"
                               href="#" role="button" data-te-dropdown-toggle-ref aria-expanded="false">
                                <!-- User avatar -->
                                <img class="mr-3 w-10 h-10 object-cover rounded-full"
                                     th:src="'/sunn'+${listaReproduccion[0].noticia.usuario.fotoPerfil}"
                                     alt="foto de messi.jpeg">
                                <span class="font-bold" th:text="${listaReproduccion[0].noticia.usuario.nombre}"></span>
                                <span th:text="${listaReproduccion[0].noticia.fechaDePublicacion}" class="ml-4"></span>
                            </a>
                        </div>

                        <h1 th:text="${listaReproduccion[0].noticia.titulo}"
                            class="mt-6 mb-10 text-3xl lg:text-5xl xl:text-5xl font-bold text-left">
                        </h1>

                        <p th:text="${listaReproduccion[0].noticia.resumen}" class="mt-3 xl:mb-16 text-xl text-left">
                        </p>

                    </div>
                    <div class="px-6 text-center text-white md:px-12 xl:w-2/5 flex flex-col">
                        <div class="m-auto">
                            <button class="btnReproducirAnterior">
                                <svg xmlns="http://www.w3.org/2000/svg" height="5em" viewBox="0 0 320 512">
                                    <!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2023 Fonticons, Inc. -->
                                    <style>svg{fill:#ffffff}</style>
                                    <path d="M267.5 440.6c9.5 7.9 22.8 9.7 34.1 4.4s18.4-16.6 18.4-29V96c0-12.4-7.2-23.7-18.4-29s-24.5-3.6-34.1 4.4l-192 160L64 241V96c0-17.7-14.3-32-32-32S0 78.3 0 96V416c0 17.7 14.3 32 32 32s32-14.3 32-32V271l11.5 9.6 192 160z"/>
                                </svg>
                            </button>
                            <button class="btnReproducirPausa m-10" onclick="wavesurfer.playPause()">
                                <svg xmlns="http://www.w3.org/2000/svg" height="10em" viewBox="0 0 512 512">
                                    <!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2023 Fonticons, Inc. -->
                                    <style>svg{fill:#ffffff}</style>
                                    <path d="M464 256A208 208 0 1 0 48 256a208 208 0 1 0 416 0zM0 256a256 256 0 1 1 512 0A256 256 0 1 1 0 256zM188.3 147.1c7.6-4.2 16.8-4.1 24.3 .5l144 88c7.1 4.4 11.5 12.1 11.5 20.5s-4.4 16.1-11.5 20.5l-144 88c-7.4 4.5-16.7 4.7-24.3 .5s-12.3-12.2-12.3-20.9V168c0-8.7 4.7-16.7 12.3-20.9z"/>
                                </svg>
                            </button>
                            <button class="btnReproducirPausa m-10" onclick="wavesurfer.playPause()" hidden>
                                <svg xmlns="http://www.w3.org/2000/svg" height="10em" viewBox="0 0 320 512">
                                    <!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2023 Fonticons, Inc. -->
                                    <style>svg{fill:#ffffff}</style>
                                    <path d="M48 64C21.5 64 0 85.5 0 112V400c0 26.5 21.5 48 48 48H80c26.5 0 48-21.5 48-48V112c0-26.5-21.5-48-48-48H48zm192 0c-26.5 0-48 21.5-48 48V400c0 26.5 21.5 48 48 48h32c26.5 0 48-21.5 48-48V112c0-26.5-21.5-48-48-48H240z"/>
                                </svg>
                            </button>
                            <button class="btnReproducirAnterior">
                                <svg xmlns="http://www.w3.org/2000/svg" height="5em" viewBox="0 0 320 512">
                                    <!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2023 Fonticons, Inc. -->
                                    <style>svg{fill:#ffffff}</style>
                                    <path d="M52.5 440.6c-9.5 7.9-22.8 9.7-34.1 4.4S0 428.4 0 416V96C0 83.6 7.2 72.3 18.4 67s24.5-3.6 34.1 4.4l192 160L256 241V96c0-17.7 14.3-32 32-32s32 14.3 32 32V416c0 17.7-14.3 32-32 32s-32-14.3-32-32V271l-11.5 9.6-192 160z"/>
                                </svg>
                            </button>
                        </div>
                        <button onclick="wavesurfer.stop()" class="ml-auto mr-10" hidden>
                            <svg xmlns="http://www.w3.org/2000/svg" height="4em" viewBox="0 0 512 512">
                                <!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2023 Fonticons, Inc. -->
                                <path d="M464 256A208 208 0 1 0 48 256a208 208 0 1 0 416 0zM0 256a256 256 0 1 1 512 0A256 256 0 1 1 0 256zm192-96H320c17.7 0 32 14.3 32 32V320c0 17.7-14.3 32-32 32H192c-17.7 0-32-14.3-32-32V192c0-17.7 14.3-32 32-32z"/>
                            </svg>
                        </button>
                        <audio id="audio" th:src="'/sunn'+${listaReproduccion[0].noticia.rutaDeAudioPodcast}"></audio>
                        <div id="waveform" class="w-full h-24">

                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="pb-4">
            <div id="play-list" th:each="lista : ${listaReproduccion}" class="mx-auto">
                <div class="flex xl:p-10 xl:px-32 py-4 px-1">
                    <div class="w-16 h-16 overflow-hidden my-auto">
                        <img th:src="@{${lista.noticia.rutaDeimagen}}"
                             class="w-full h-full object-cover rounded-md">
                    </div>

                    <div class="w-[58%] m-auto">
                        <p th:text="${lista.noticia.titulo}" class="text-white font-semibold text-3xl ml-6"></p>
                        <!--<img th:src="@{/imagenes/basura.png}" class="h-[15%] w-[7%] mt-10 ml-6">-->
                    </div>
                    <div class="text-white w-[10%] text-center my-auto">
                        <p class="duracion-audio "></p>
                    </div>
                    <div class="w-[10%] flex items-center justify-around">
                        <audio th:id="${lista.noticia.idNoticia}" th:src="@{${lista.noticia.rutaDeAudioPodcast}}"
                               class="audioElemento"></audio>
                        <button class="playButton" th:name="${lista.noticia.idNoticia}">
                            <svg xmlns="http://www.w3.org/2000/svg" height="2em" viewBox="0 0 512 512">
                                <style> svg {
                                fill: #ffffff
                            }
                                </style>
                                <path d="M464 256A208 208 0 1 0 48 256a208 208 0 1 0 416 0zM0 256a256 256 0 1 1 512 0A256 256 0 1 1 0 256zM188.3 147.1c7.6-4.2 16.8-4.1 24.3 .5l144 88c7.1 4.4 11.5 12.1 11.5 20.5s-4.4 16.1-11.5 20.5l-144 88c-7.4 4.5-16.7 4.7-24.3 .5s-12.3-12.2-12.3-20.9V168c0-8.7 4.7-16.7 12.3-20.9z"/>
                            </svg>
                        </button>
                        <button class="removeButton" th:name="${lista.noticia.idNoticia}">
                            <svg xmlns="http://www.w3.org/2000/svg" height="2em" viewBox="0 0 448 512">
                                <!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2023 Fonticons, Inc. -->
                                <style>svg{fill:#ffffff}</style>
                                <path d="M170.5 51.6L151.5 80h145l-19-28.4c-1.5-2.2-4-3.6-6.7-3.6H177.1c-2.7 0-5.2 1.3-6.7 3.6zm147-26.6L354.2 80H368h48 8c13.3 0 24 10.7 24 24s-10.7 24-24 24h-8V432c0 44.2-35.8 80-80 80H112c-44.2 0-80-35.8-80-80V128H24c-13.3 0-24-10.7-24-24S10.7 80 24 80h8H80 93.8l36.7-55.1C140.9 9.4 158.4 0 177.1 0h93.7c18.7 0 36.2 9.4 46.6 24.9zM80 128V432c0 17.7 14.3 32 32 32H336c17.7 0 32-14.3 32-32V128H80zm80 64V400c0 8.8-7.2 16-16 16s-16-7.2-16-16V192c0-8.8 7.2-16 16-16s16 7.2 16 16zm80 0V400c0 8.8-7.2 16-16 16s-16-7.2-16-16V192c0-8.8 7.2-16 16-16s16 7.2 16 16zm80 0V400c0 8.8-7.2 16-16 16s-16-7.2-16-16V192c0-8.8 7.2-16 16-16s16 7.2 16 16z"/>
                            </svg>
                        </button>
                    </div>
                </div>
                <hr class="xl:mx-32">
            </div>

        </div>
    </div>
</main>

<script src="https://cdn.jsdelivr.net/npm/tw-elements/dist/js/tw-elements.umd.min.js"></script>
<script src="https://cdn.jsdelivr.net/gh/alpinejs/alpine@v2.x.x/dist/alpine.min.js" defer></script>


<!-- jQuery -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

<!--<script>
    $(document).ready(function () {

        $('.playButton').on('click', function () {
            var idAudio = "#" + $(this).attr("name");
            var elementoAudio = $(idAudio)[0];

            if (elementoAudio.paused) {
                elementoAudio.play();
            } else {
                elementoAudio.pause();
            }
        });
    });
</script>-->

<script src="https://unpkg.com/wavesurfer.js@7"></script>
<script>
$(document).ready(function () {
    $(document).on("click", ".btnReproducirPausa", function () {
        // Encuentra el botón que se hizo clic
        var clickedButton = $(this);

        // Oculta el botón clicado
        clickedButton.hide();

        // Muestra el siguiente botón con la misma clase o el primero si no hay uno siguiente
        var nextButton = clickedButton.next(".btnReproducirPausa");
        if (nextButton.length === 0) {
            nextButton = clickedButton.siblings(".btnReproducirPausa:first");
        }
        nextButton.show();
    });


});




 // Inicializa Wavesurfer Podcast
        const wavesurfer = WaveSurfer.create({
            container: '#waveform',
            waveColor: 'Gray',
            progressColor: 'white',
            cursorColor: 'white',
        });

        // Carga un archivo de audio
        wavesurfer.load($("#audio").attr("src"));

        wavesurfer.on('finish', function () {
        // Muestra el primer botón y oculta el sunguno
        $(".btnReproducirPausa").first().show();
        $(".btnReproducirPausa").last().hide();
        });

        function reproducirAudio(audioData) {
        var blob = new Blob([audioData], { type: "audio/wav" });
        var audioUrl = URL.createObjectURL(blob);
        $("#reproductor").attr("src", audioUrl);
        $("#reproductor")[0].load();
        $("#reproductor")[0].play();
        }




</script>
<script th:src="@{/js/duracionAudios.js}"></script>


<script th:src="@{/js/likearNoticia.js}"></script>
<script th:src="@{/js/playList.js}"></script>
</body>
</html>